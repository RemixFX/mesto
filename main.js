(()=>{"use strict";class e{constructor(e,t,s){this._name=e.name,this._link=e.link,this._alt=e.alt,this._handleCardClick=s,this._cardSelector=t}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".element").cloneNode(!0)}generateCard(){this._element=this._getTemplate();const e=this._element.querySelector(".element__image");return this._element.querySelector(".element__name").textContent=this._name,e.src=this._link,e.alt=this._alt,this._setEventListeners(),this._element}_addLike(e){e.target.classList.toggle("element__like-button_type_active")}_animation(){this._element.classList.add("element-animated")}_removeCard(){this._element.remove()}_setEventListeners(){this._element.querySelector(".element__like-button").addEventListener("click",(e=>this._addLike(e))),this._element.querySelector(".element__delete-button").addEventListener("click",(()=>this._animation())),this._element.addEventListener("animationend",(()=>this._removeCard())),this._element.querySelector(".element__image").addEventListener("click",(()=>this._handleCardClick(this._name,this._link)))}}class t{constructor(e,t){this._formElement=t,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._buttonElement=this._formElement.querySelector(this._submitButtonSelector)}_showInputError(e){this._getErrorElement(e),e.classList.add(this._inputErrorClass),this._errorElement.textContent=e.validationMessage,this._errorElement.classList.add(this._errorClass)}_hideInputError(e){this._getErrorElement(e),e.classList.remove(this._inputErrorClass),this._errorElement.classList.remove(this._errorClass)}_getErrorElement(e){this._errorElement=this._formElement.querySelector(`#${e.id}-error`)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e,this._inputErrorClass,this._errorClass):this._showInputError(e,this._inputErrorClass,this._errorClass)}_checkFormValidity(){return this._inputList.some((e=>!e.validity.valid))}_toggleButtonState(){this._checkFormValidity(this._inputList)?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.setAttribute("disabled","good")):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.removeAttribute("disabled"))}resetValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{this._hideInputError(e)}))}_setEventListeners(){this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))})),this._toggleButtonState()}enableValidation(){this._setEventListeners()}}class s{constructor(e){this._popup=document.querySelector(e)}open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popup.addEventListener("click",(e=>{e.target.classList.contains("popup_opened")&&this.close(),e.target.classList.contains("popup__close-button")&&this.close()}))}}class r extends s{constructor({handleFormSubmit:e,popupSelector:t}){super(t),this._handleFormSubmit=e,this._form=this._popup.querySelector(".form"),this._inputList=this._popup.querySelectorAll(".form__input")}_getInputValues(){return this._formValues={},this._inputList.forEach((e=>{this._formValues[e.name]=e.value})),this._formValues}close(){super.close(),this._form.reset()}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}}const n={inputSelector:".form__input",submitButtonSelector:".form__submit-button",inactiveButtonClass:"form__submit-button_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__error_visible"},i=document.querySelector(".profile__edit-button"),o=document.querySelector(".form__input_type_name"),l=document.querySelector(".form__input_type_job"),a=document.querySelector(".profile__add-button"),c=document.querySelector(".form-add-card"),_=document.querySelector(".form-profile"),u=new class extends s{constructor(e){super(e),this._imagePopupName=document.querySelector(".popup-card__image-name"),this._imagePopupLink=document.querySelector(".popup-card__image")}open({name:e,link:t}){super.open(),this._imagePopupName.textContent=e,this._imagePopupLink.src=t}}(".popup-card");u.setEventListeners();const d=new class{constructor(e,t){this._profileName=document.querySelector(e),this._profileJob=document.querySelector(t)}getUserInfo(){return{name:this._profileName.textContent,job:this._profileJob.textContent}}setUserInfo(e){this._profileName.textContent=e.nickname,this._profileJob.textContent=e.job,console.log(e.name),console.log(e.job)}}(".profile__name",".profile__job"),p=new r({popupSelector:".popup_type_edit-profile",handleFormSubmit:e=>{console.log(e),d.setUserInfo(e),p.close()}});p.setEventListeners(),i.addEventListener("click",(function(){const e=d.getUserInfo();o.value=e.name,l.value=e.job,y.resetValidation(),p.open()}));const m=(e,t)=>u.open({name:e,link:t}),h=t=>new e(t,"#elements-template",m).generateCard(),E=new class{constructor({items:e,renderer:t},s){this._renderedItems=e,this._renderer=t,this._container=document.querySelector(s)}addItem(e){this._container.prepend(e)}renderItems(){this._renderedItems.forEach((e=>{this._renderer(e)}))}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg",alt:"горные хребты с переходом от заснеженных верхушек до зеленых склонов"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg",alt:"ещё не замерзшее озере на опушке леса в зимнюю пору"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg",alt:"плотная застройка однотипными девятиэтажными домами"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg",alt:"темный грунт, редкая растительность, высокая гора с заснеженным склоном"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg",alt:"железная дорога уходящая в даль, вдоль лесистой местности"},{name:"Франция",link:"https://myspace.ge/file/pic/photo/2018/02/573d18c9c0d7dcc46fec3abcc8d9ae80.gif",alt:"Замок Шамбор Франция"}],renderer:e=>{E.addItem(h(e))}},".elements");E.renderItems();const v=new r({popupSelector:".popup_type_add-card",handleFormSubmit:e=>{E.addItem(h(e)),v.close()}});v.setEventListeners(),a.addEventListener("click",(()=>{v.open(),f.resetValidation()}));const f=new t(n,c);f.enableValidation();const y=new t(n,_);y.enableValidation()})();